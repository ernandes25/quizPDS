<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro</title>
    <link rel="stylesheet" href="./style.css" />
</head>
<body>
    <header>
        <nav>
            <ul>
                <img id="logo" src="logo.jpeg" />
            </ul>
            <ul>
                <a class="item" href="./index.html">
                    <li>Início</li>
                </a>
            </ul>
            <ul>
                <a class="item" href="./Home">
                    <li>Sobre nós</li>
                </a>
            </ul>
            <ul>
                <a class="item" href="./contato.html">
                    <li>Contato</li>
                </a>
            </ul>
            <ul>
                <a class="item" href="cadastro.html">
                    <li>Cadastro</li>
                </a>
            </ul>
            <ul class="dropdown">
                <a class="item" href="#">
                    <li>Administração</li>
                </a>
                <div class="dropdown-content">
                    <a href="config_email.html">Cadastrar Email</a>
                    <a href="admin_login.html">Login do Administrador</a>
                </div>
            </ul>
            <ul id="logout" style="display: none;">
                <button onclick="logout()">Sair</button>
            </ul>
        </nav>
    </header>
    <h1>Cadastro de Usuário</h1>
    <div class="form">
      <section>
        <form id="userForm" method="POST" action="process_form.php">
          <label for="nome">Nome:</label>
          <input type="text" id="nome" name="nome" required><br>
          <label for="email">Email:</label>
          <input type="email" id="email" name="email" required><br>
          <label for="telefone">Telefone:</label>
          <input type="text" id="telefone" name="telefone" required><br>
          <input type="hidden" id="usuario" name="usuario" value="">
          <input type="hidden" id="senha" name="senha" value="">
          <button type="submit">Cadastrar</button>
        </form>
      </section>
      <div id="response-message"></div>
    </div>

    <footer>
        <img id="logo" src="./logo.jpeg" />
        <span>Todos os direitos reservados &copy;</span>
        <span>Desenvolvido por: Bay Software - H & E Silva</span>
    </footer>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const urlParams = new URLSearchParams(window.location.search);
        const usuario = urlParams.get('usuario');
        const senha = urlParams.get('senha');
        if (usuario) {
          document.getElementById('usuario').value = usuario;
        }
        if (senha) {
          document.getElementById('senha').value = senha;
        }
  
        const userForm = document.getElementById('userForm');
        const responseMessage = document.getElementById('response-message');
  
        userForm.addEventListener('submit', function (event) {
          event.preventDefault();
          const formData = new FormData(userForm);
          fetch('process_form.php', {
            method: 'POST',
            body: formData
          })
          .then(response => response.json())
          .then(data => {
            responseMessage.innerHTML = data.message;
            if (data.status === 'success') {
              localStorage.setItem('user', formData.get('usuario')); // Armazena o usuário no localStorage
              userForm.reset();
              setTimeout(() => {
                window.location.href = 'quiz.html'; // Redireciona para a página de quiz
              }, 2000); // Espera 2 segundos antes de redirecionar
            }
          })
          .catch(error => {
            console.error('Erro:', error);
            responseMessage.innerHTML = 'Ocorreu um erro ao processar sua solicitação. Por favor, tente novamente mais tarde.';
          });
        });
      });
    </script>
</body>
</html>
